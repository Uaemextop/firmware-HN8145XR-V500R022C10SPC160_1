#Thu Jul 31 19:49:08 CST 2014
# 0 系统和预置插件:		允许获取 osgishellservice 服务  
0-COMMADN_SERVICE_ALLOW= ALLOW { [com.huawei.smartgateway.security.conditions.SysAndPreBundleCondition]  (org.osgi.framework.ServicePermission "com.huawei.smartgateway.deviceservice.interfaces.osgishellservice.*" "get")} "COMMADN_SERVICE_ALLOW"

# 1 迅雷插件： 			允许获取 osgishellservice 服务 
1-COMMADN_SERVICE_ALLOW2= ALLOW { [com.huawei.smartgateway.security.conditions.ThunderBundleCondition]  (org.osgi.framework.ServicePermission "com.huawei.smartgateway.deviceservice.interfaces.osgishellservice.*" "get")} "COMMADN_SERVICE_ALLOW2"

# 2 第三方插件： 		允许访问/var/felix-temp目录  /mnt/jffs2/app/osgi/felix-cache子目录能读写
2-TRDPARTY_TEMP_WRITE_ALLOW= ALLOW { [com.huawei.smartgateway.security.conditions.ThirdPartyBundleCondition]  (java.io.FilePermission "/mnt/jffs2/app/osgi/felix-cache/-" "write,read,execute,delete")  (java.io.FilePermission "/var/felix-temp/-" "write,read,execute,delete") (java.io.FilePermission "/mnt/jffs2/app/osgi/felix-cache" "read") (java.io.FilePermission "/var/felix-temp" "read") } "TRDPARTY_TEMP_WRITE_ALLOW"

# 3 移动预置插件： 		允许使用SecurityPermission等全选
3-CMCC_JAVA_PERM_ALLOW= ALLOW { [com.huawei.smartgateway.security.conditions.CmccBundleCondition]  (java.lang.RuntimePermission "setSecurityManager") (java.lang.RuntimePermission "createSecurityManager") (java.lang.RuntimePermission "createClassLoader") (java.lang.RuntimePermission "closeClassLoader") (java.lang.RuntimePermission "setDefaultUncaughtExceptionHandler") (java.lang.RuntimePermission "getProtectionDomain") (java.lang.RuntimePermission "setIO") (java.lang.RuntimePermission "exitVM.*") (java.security.SecurityPermission "*") } "CMCC_JAVA_PERM_ALLOW"

# 4 第三方插件的权限 ：	限制 管理其他插件生命周期的权限、持久化文件夹下所有文件的执行权限、 获取osgishellservice 服务的权限、获取CPA服务的权限
4-DENY_ADMIN_PERMISSION=DENY { [com.huawei.smartgateway.security.conditions.ThirdPartyBundleCondition] (org.osgi.framework.AdminPermission "*" "lifecycle,execute") (java.io.FilePermission "<<ALL FILES>>" "execute") (java.io.FilePermission "/mnt/jffs2/-" "delete")(java.io.FilePermission "/mnt/jffs2" "delete") (java.io.FilePermission "/mnt/jffs2/app/osgi/security/-" "read,write,delete") (java.io.FilePermission "/var/-" "write,delete")  (java.lang.RuntimePermission "setSecurityManager") (java.lang.RuntimePermission "createSecurityManager") (java.lang.RuntimePermission "createClassLoader") (java.lang.RuntimePermission "closeClassLoader") (java.lang.RuntimePermission "setDefaultUncaughtExceptionHandler") (java.lang.RuntimePermission "getProtectionDomain") (java.lang.RuntimePermission "setIO") (java.lang.RuntimePermission "exitVM.*") (java.security.SecurityPermission "*") (org.osgi.framework.ServicePermission "com.huawei.smartgateway.deviceservice.interfaces.osgishellservice.*" "get")  (org.osgi.framework.ServicePermission "org.osgi.service.condpermadmin.*" "get") (org.osgi.framework.ServicePermission "(&(objectClass=com.chinamobile.smartgateway.commservices.DeviceAccessRightQueryService)(key=Inner))" "get") (org.osgi.framework.ServicePermission "(&(objectClass=com.chinamobile.smartgateway.commservices.DeviceAccessRightConfigService)(key=Inner))" "get")(org.osgi.framework.ServicePermission "(&(objectClass=com.huawei.smartgateway.deviceservice.interfaces.voiceservice.IVoiceService)(key=Inner))" "get")(org.osgi.framework.ServicePermission "(&(objectClass=com.huawei.smartgateway.deviceservice.interfaces.commonservice.ICommonService)(key=Inner))" "get")(org.osgi.framework.ServicePermission "(&(objectClass=com.huawei.smartgateway.deviceservice.interfaces.bundlemanageservice.IBundleManageService)(key=Inner))" "get")(org.osgi.framework.ServicePermission "(&(objectClass=com.huawei.smartgateway.commservices.DeviceInfoQueryService)(key=Inner))" "get")(org.osgi.framework.ServicePermission "(&(objectClass=com.huawei.smartgateway.commservices.DeviceAccessRightQueryService)(key=Inner))" "get")(org.osgi.framework.ServicePermission "(&(objectClass=com.huawei.smartgateway.accessservices.AccessInfoQueryService)(key=Inner))" "get")} "DENY_ADMIN_PERMISSION"  

# 5 所有权限                                                               
5-ALL_PERMISSION=ALLOW { [org.osgi.service.condpermadmin.BundleLocationCondition "*"] (java.security.AllPermission "" "") } "---ALL_PERMISSION" 